{"mappings":";;;;;;;;;;;;;;;;ACIA,gBAAS;AAEF,KAAK,CAAC,yCAAe,IAAI,CAAC,QAAC,KAAK,eAAE,UAAU,aAAE,QAAQ,EAAC,CAAC,GAAK,CAAC;IACnE,KAAK,EAAE,OAAO,EAAE,UAAU,IAAI,eAAQ,CAAC,KAAK;IAE5C,KAAK,CAAC,aAAa,GAAG,kBAAW,EAC9B,OAAO,GAAK,CAAC;QACZ,UAAU,EAAE,KAAK,GAAK,CAAC;YACrB,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO;QAC9B,CAAC;IACH,CAAC,EACD,CAAC;QAAA,UAAU;IAAA,CAAC;IAEd,KAAK,CAAC,iBAAiB,GAAG,kBAAW,EAClC,QAAQ,GAAK,CAAC;QACb,UAAU,EAAE,KAAK,GAAK,CAAC;YACrB,QAAQ,CAAC,OAAO,EAAE,GAAG,GAAK,CAAC;gBACzB,MAAM,CAAC,KAAK,CAAC,GAAG;YAClB,CAAC;QACH,CAAC;IACH,CAAC,EACD,CAAC;QAAA,UAAU;IAAA,CAAC;IAGd,EAA6E,AAA7E,2EAA6E;IAC7E,KAAK,CAAC,YAAY,GAAG,cAAO,MACnB,CAAC;eACH,OAAO;2BACV,aAAa;+BACb,iBAAiB;QACnB,CAAC;MACD,CAAC;QAAA,OAAO;QAAE,aAAa;QAAE,iBAAiB;IAAA,CAAC;IAE7C,MAAM,0BACH,UAAU,CAAC,QAAQ;QAAC,KAAK,EAAE,YAAY;kBAAG,QAAQ;;AAEvD,CAAC;AAEM,KAAK,CAAC,yCAAgB,IAC3B,cAAc,EACd,UAAU,EACV,gBAAgB,GACb,CAAC;IACJ,KAAK,CAAC,OAAO,GAAG,iBAAU,CAAC,UAAU;IACrC,KAAK,CAAC,UAAU,GAAG,gBAAgB,CAChC,MAAM,EAAE,GAAG,GAAK,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG;MACjE,GAAG,EAAE,GAAG,GAAK,CAAC;QACP,OAAO,CAAC,GAAG;IACnB,CAAC;IACH,KAAK,CAAC,YAAY,GAAG,MAAM,CAAC,WAAW,CAAC,UAAU;IAClD,KAAK,CAAC,OAAO,iBAAG,WAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QAC5C,MAAM,0BAAE,cAAc;eAAK,KAAK;sBAAG,KAAK,CAAC,QAAQ;;IACnD,CAAC;IAED,MAAM,CAAC,CAAC;QAAA,OAAO;QAAE,YAAY;IAAA,CAAC;AAChC,CAAC,CACD,CAAQ,AAAR,EAAQ,AAAR,MAAQ;AACR,CAAiE,AAAjE,EAAiE,AAAjE,+DAAiE;AAEjE,CAAiH,AAAjH,EAAiH,AAAjH,+GAAiH;AAEjH,CAAyF,AAAzF,EAAyF,AAAzF,uFAAyF;AAEzF,CAAqG,AAArG,EAAqG,AAArG,mGAAqG;AAErG,CAAQ,AAAR,EAAQ,AAAR,MAAQ;AACR,CAgBE,AAhBF,EAgBE,AAhBF;;;;;;;;;;;;;;;;AAgBE,AAhBF,EAgBE,CAEF,CAAa,AAAb,EAAa,AAAb,WAAa;AACb,CAYE,AAZF,EAYE,AAZF;;;;;;;;;;;;AAYE,AAZF,EAYE;;;ADpGF,GAAuB;AAAvB,yCAAuB,GAAG,yCAAe","sources":["src/index.js","src/components/ContextHelper.js"],"sourcesContent":["import { ContextProvider } from \"./components/ContextHelper\";\nexports.ContextProvider = ContextProvider;\n","import { useCallback, useContext, memo, useMemo } from \"react\";\nimport { enableES5 } from \"immer\";\nimport { useImmer } from \"use-immer\";\nimport React from \"react\";\nenableES5();\n\nexport const ContextProvider = ({ value, contextObj, children }) => {\n  const [context, setContext] = useImmer(value);\n\n  const updateContext = useCallback(\n    (toMerge) => {\n      setContext((draft) => {\n        Object.assign(draft, toMerge);\n      });\n    },\n    [setContext],\n  );\n  const removeFromContext = useCallback(\n    (toDelete) => {\n      setContext((draft) => {\n        toDelete.forEach((key) => {\n          delete draft[key];\n        });\n      });\n    },\n    [setContext],\n  );\n\n  //prevents a rerender in consumers every time the Provider's parent rerenders\n  const contextValue = useMemo(\n    () => ({\n      ...context,\n      updateContext,\n      removeFromContext,\n    }),\n    [context, updateContext, removeFromContext],\n  );\n  return (\n    <contextObj.Provider value={contextValue}>{children}</contextObj.Provider>\n  );\n};\n\nexport const useMemoComponent = (\n  ChildComponent,\n  ContextObj,\n  contextPropsKeys,\n) => {\n  const context = useContext(ContextObj);\n  const contextMap = contextPropsKeys\n    .filter((key) => Object.prototype.hasOwnProperty.call(context, key))\n    .map((key) => {\n      [key, context[key]];\n    });\n  const contextProps = Object.fromEntries(contextMap);\n  const Wrapper = memo(function Wrapper(props) {\n    return <ChildComponent {...props}>{props.children}</ChildComponent>;\n  });\n\n  return [Wrapper, contextProps];\n};\n//usage:\n// const [MemoizedChildComponent, contextProps] = useContext(...)\n\n//return <MemoizedChildComponent {...contextProps} {..any other props}><ChildComponent/></MemoizedChildComponent>\n\n//write cli that takes a component and determines if it's better to use React.memo or not\n\n//context objects will be exported using a named export in the same file the ContextProvider is used:\n\n//App.js\n/*\nimport ContextProvider from 'react-context-helper';\n\nexport const Context = React.createContext();\n\nexport default function App() {\n  const initialValue = {\n    foo: bar,\n    fizz: buzz,\n  };\n  return (\n    <ContextProvider value={initialValue} contextObj={Context}>\n      <User />\n    </ContextProvider>\n  )\n}\n*/\n\n//Consumer.js\n/*\nimport { useMemoizedChild } from \"react-context-helper\";\nimport Context from \"/path/to/App.js\";\nimport ChildComponent from \"/path/to/ChildComponent.js\";\n\nexport default function Consumer = () => {\nconst [MemoizedChildComponent, contextProps] = \n  useMemoComponent(ChildComponent, Context, [\"foo\"]);\n\nreturn \n  <MemoizedChildComponent {...contextProps} {..any other props}/> \n}\n*/\n"],"names":[],"version":3,"file":"module.js.map"}